CLSCTX_INPROC_SERVER = 0x00000001
DPENUMSESSIONS_AVAILABLE = 0x00000001
DPENUMPLAYERS_ALL = 0x00000000
DPOPEN_JOIN = 0x00000001
DPSEND_GUARANTEED = 0x00000001
DPID_ALLPLAYERS = 0x00000000
DPRECEIVE_ALL = 0x00000001

ERROR_INCORRECT_BUFFER_SIZE = 0x8877001E

struc IDirectPlayLobby {
      .QueryInterface		   dd ?
      .AddRef			   dd ?
      .Release			   dd ?
      .Connect			   dd ?
      .CreateAddress		   dd ?
      .EnumAddress		   dd ?
      .EnumAddressTypes 	   dd ?
      .EnumLocalApplications	   dd ?
      .GetConnectionSettings	   dd ?
      .ReceiveLobbyMessage	   dd ?
      .RunApplication		   dd ?
      .SendLobbyMessage 	   dd ?
      .SetConnectionSettings	   dd ?
      .SetLobbyMessageEvent	   dd ?
}
struc IDirectPlayLobby2 {
      .QueryInterface		   dd ?
      .AddRef			   dd ?
      .Release			   dd ?
      .Connect			   dd ?
      .CreateAddress		   dd ?
      .EnumAddress		   dd ?
      .EnumAddressTypes 	   dd ?
      .EnumLocalApplications	   dd ?
      .GetConnectionSettings	   dd ?
      .ReceiveLobbyMessage	   dd ?
      .RunApplication		   dd ?
      .SendLobbyMessage 	   dd ?
      .SetConnectionSettings	   dd ?
      .SetLobbyMessageEvent	   dd ?
      .CreateCompoundAddress	   dd ?
}

struc IDirectPlay4 {
      .QueryInterface		   dd ?
      .AddRef			   dd ?
      .Release			   dd ?
      .AddPlayerToGroup 	   dd ?
      .Close			   dd ?
      .CreateGroup		   dd ?
      .CreatePlayer		   dd ?
      .DeletePlayerFromGroup	   dd ?
      .DestroyGroup		   dd ?
      .DestroyPlayer		   dd ?
      .EnumGroupPlayers 	   dd ?
      .EnumGroups		   dd ?
      .EnumPlayers		   dd ?
      .EnumSessions		   dd ?
      .GetCaps			   dd ?
      .GetGroupData		   dd ?
      .GetGroupName		   dd ?
      .GetMessageCount		   dd ?
      .GetPlayerAddress 	   dd ?
      .GetPlayerCaps		   dd ?
      .GetPlayerData		   dd ?
      .GetPlayerName		   dd ?
      .GetSessionDesc		   dd ?
      .Initialize		   dd ?
      .Open			   dd ?
      .Receive			   dd ?
      .Send			   dd ?
      .SetGroupData		   dd ?
      .SetGroupName		   dd ?
      .SetPlayerData		   dd ?
      .SetPlayerName		   dd ?
      .SetSessionDesc		   dd ?
      .AddGroupToGroup		   dd ?
      .CreateGroupInGroup	   dd ?
      .DeleteGroupFromGroup	   dd ?
      .EnumConnections		   dd ?
      .EnumGroupsInGroup	   dd ?
      .GetGroupConnectionSettings  dd ?
      .InitializeConnection	   dd ?
      .SecureOpen		   dd ?
      .SendChatMessage		   dd ?
      .SetGroupConnectionSettings  dd ?
      .StartSession		   dd ?
      .GetGroupFlags		   dd ?
      .GetGroupParent		   dd ?
      .GetPlayerAccount 	   dd ?
      .GetPlayerFlags		   dd ?
      .GetGroupOwner		   dd ?
      .SetGroupOwner		   dd ?
      .SendEx			   dd ?
      .GetMessageQueue		   dd ?
      .CancelMessage		   dd ?
      .CancelPriority		   dd ?
}

struc DPSESSIONDESC2 {
      .dwSize			   dd ?
      .dwFlags			   dd ?
      .guidInstance		   db 16 dup (?)
      .guidApplication		   db 16 dup (?)
      .dwMaxPlayers		   dd ?
      .dwCurrentPlayers 	   dd ?
      .lpszSessionName		   dd ?
      .lpszPassword		   dd ?
      .dwReserved1		   dd ?
      .dwReserved2		   dd ?
      .dwUser1			   dd ?
      .dwUser2			   dd ?
      .dwUser3			   dd ?
      .dwUser4			   dd ?
}
virtual at 0
	DPSESSIONDESC2 DPSESSIONDESC2
sizeof.DPSESSIONDESC2:
end virtual

struc DPNAME {
      .dwSize			   dd ?
      .dwFlags			   dd ?
      .lpszShortName		   dd ?
      .lpszLongName		   dd ?
}
virtual at 0
	DPNAME DPNAME
sizeof.DPNAME:
end virtual